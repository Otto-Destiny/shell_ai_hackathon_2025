<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuel Blend Optimizer Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .main-header {
            background: linear-gradient(90deg, #FF6B35 0%, #F7931E 100%);
            padding: 2rem;
            border-radius: 15px;
            color: white;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: slideDown 0.8s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .main-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .main-header h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .main-header p {
            font-size: 1rem;
            opacity: 0.8;
        }

        .nav-tabs {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .nav-tab {
            flex: 1;
            padding: 12px 20px;
            text-align: center;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(255,107,53,0.4);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 1.5rem;
            border-radius: 15px;
            color: white;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: fadeInUp 0.6s ease-out;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        @keyframes fadeInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .metric-card h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .metric-card h2 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .metric-card p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .blend-designer {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .prediction-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .optimization-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .slider-container {
            margin: 15px 0;
        }

        .slider-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FF6B35;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FF6B35;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .btn {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,107,53,0.3);
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,107,53,0.4);
        }

        .chart-container {
            height: 400px;
            margin: 20px 0;
            position: relative;
        }

        .property-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .property-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(5px);
            position: relative;
        }

        .property-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .property-name {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .delta-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.8rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .delta-positive {
            background: #28a745;
            color: white;
        }

        .delta-negative {
            background: #dc3545;
            color: white;
        }

        .warning-panel {
            background: rgba(255,193,7,0.2);
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .warning-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .warning-icon {
            margin-right: 8px;
            font-size: 1.1rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .blend-comparison {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: rgba(255,255,255,0.8);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .radar-chart {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .optimization-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .result-item {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* AI Assistant Styles */
        .ai-assistant-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .assistant-toggle {
            background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255,107,53,0.4);
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .assistant-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,107,53,0.5);
        }

        .assistant-panel {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 0;
            width: 350px;
            height: 400px;
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            display: flex;
            flex-direction: column;
        }

        .assistant-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            max-height: 280px;
        }

        .message {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .ai-message {
            background: rgba(102, 126, 234, 0.1);
            border-left: 3px solid #667eea;
        }

        .user-message {
            background: rgba(255, 107, 53, 0.1);
            border-left: 3px solid #FF6B35;
            text-align: right;
        }

        .chat-input-container {
            padding: 15px;
            border-top: 1px solid rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
        }

        #chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            outline: none;
        }

        .anomaly-alert {
            background: rgba(220, 53, 69, 0.1);
            border: 2px solid #dc3545;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .anomaly-icon {
            color: #dc3545;
            font-size: 1.2rem;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="main-header">
            <h1>Eagle Blend Optimizer</h1>
            <h3>AI-Powered Fuel Blend Property Prediction & Optimization</h3>
            <p>Shell AI Hackathon Phase 2 Solution | Eagle Team</p>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">🏠 Dashboard</button>
            <button class="nav-tab" onclick="showTab('designer')">🧪 Blend Designer</button>
            <button class="nav-tab" onclick="showTab('analyzer')">📊 Property Analyzer</button>
            <button class="nav-tab" onclick="showTab('optimizer')">🎯 Optimization Engine</button>
            <button class="nav-tab" onclick="showTab('batch')">📈 Blend Comparison</button>
            <button class="nav-tab" onclick="showTab('insights')">🔬 Model Insights</button>
        </div>

        <!-- AI Assistant Chatbot -->
        <div id="ai-assistant" class="ai-assistant-container">
            <div class="assistant-toggle" onclick="toggleAssistant()">
                🤖 AI Assistant
            </div>
            <div class="assistant-panel" id="assistant-panel">
                <div class="assistant-header">
                    <h4>🤖 Blend AI Assistant</h4>
                    <button onclick="toggleAssistant()" style="background: none; border: none; color: white; font-size: 1.2rem;">×</button>
                </div>
                <div class="chat-messages" id="chat-messages">
                    <div class="message ai-message">
                        <strong>AI:</strong> Hello! I'm your Blend AI Assistant. Ask me questions like "What can I do to reduce property 4?" or "How does Component A affect the blend?"
                    </div>
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chat-input" placeholder="Ask me about blend optimization..." onkeypress="handleChatKeypress(event)">
                    <button onclick="sendMessage()" class="btn" style="padding: 8px 15px; margin: 0;">Send</button>
                </div>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="metrics-grid">
                <div class="metric-card" style="animation-delay: 0.1s;">
                    <h3>🎯 Model Accuracy</h3>
                    <h2>94.7%</h2>
                    <p>R² Score</p>
                </div>
                <div class="metric-card" style="animation-delay: 0.2s;">
                    <h3>⚡ Predictions Made</h3>
                    <h2>12,847</h2>
                    <p>Today</p>
                </div>
                <div class="metric-card" style="animation-delay: 0.3s;">
                    <h3>🔧 Optimizations</h3>
                    <h2>156</h2>
                    <p>This Week</p>
                </div>
                <div class="metric-card" style="animation-delay: 0.4s;">
                    <h3>💰 Cost Savings</h3>
                    <h2>$2.4M</h2>
                    <p>Estimated Annual</p>
                </div>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3>📊 Real-Time Quality Monitoring</h3>
                    <div class="chart-container">
                        <canvas id="qualityChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>🔬 Current Blend Properties</h3>
                    <div class="property-grid">
                        <div class="property-item">
                            <div class="property-value">0.847</div>
                            <div class="property-name">Property 1</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.623</div>
                            <div class="property-name">Property 2</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.734</div>
                            <div class="property-name">Property 3</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.912</div>
                            <div class="property-name">Property 4</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.456</div>
                            <div class="property-name">Property 5</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.789</div>
                            <div class="property-name">Property 6</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blend Designer Tab -->
        <div id="designer" class="tab-content">
            <div class="card blend-designer">
                <h2>🧪 Interactive Blend Designer</h2>
                <p>Design your optimal fuel blend with real-time AI predictions and stability analysis</p>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3>🎛️ Component Mixer</h3>
                    
                    <div class="slider-container">
                        <label class="slider-label">Component A: <span id="compA-value">0.200</span></label>
                        <input type="range" class="slider" id="compA" min="0" max="1" step="0.001" value="0.2" onchange="updateSlider('compA')">
                    </div>
                    
                    <div class="slider-container">
                        <label class="slider-label">Component B: <span id="compB-value">0.200</span></label>
                        <input type="range" class="slider" id="compB" min="0" max="1" step="0.001" value="0.2" onchange="updateSlider('compB')">
                    </div>
                    
                    <div class="slider-container">
                        <label class="slider-label">Component C: <span id="compC-value">0.200</span></label>
                        <input type="range" class="slider" id="compC" min="0" max="1" step="0.001" value="0.2" onchange="updateSlider('compC')">
                    </div>
                    
                    <div class="slider-container">
                        <label class="slider-label">Component D: <span id="compD-value">0.200</span></label>
                        <input type="range" class="slider" id="compD" min="0" max="1" step="0.001" value="0.2" onchange="updateSlider('compD')">
                    </div>
                    
                    <div class="slider-container">
                        <label class="slider-label">Component E: <span id="compE-value">0.200</span> (Auto-calculated)</label>
                    </div>

                    <div style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <strong>Total: <span id="total-fraction">1.000</span></strong>
                        <div id="validation-message" style="margin-top: 5px; font-size: 0.9rem;">✅ Valid blend composition</div>
                    </div>

                    <div id="stability-warnings" class="warning-panel" style="display: none;">
                        <h4>⚠️ Blend Stability Warnings</h4>
                        <div id="warning-list"></div>
                    </div>

                    <div id="anomaly-detection" class="anomaly-alert" style="display: none;">
                        <h4><span class="anomaly-icon">🚨</span>Anomaly Detected</h4>
                        <div id="anomaly-message"></div>
                    </div>

                    <button class="btn" onclick="predictProperties()">🔮 Predict Properties</button>
                    <button class="btn" onclick="generateReport()">📄 Generate Report</button>
                </div>

                <div class="card">
                    <h3>📊 Predicted Blend Properties</h3>
                    <div class="radar-chart">
                        <canvas id="radarChart"></canvas>
                    </div>
                    
                    <div class="property-grid">
                        <div class="property-item">
                            <div class="delta-indicator" id="delta-1">+0%</div>
                            <div class="property-value" id="pred-1">0.652</div>
                            <div class="property-name">BlendProp 1</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator" id="delta-2">+0%</div>
                            <div class="property-value" id="pred-2">0.734</div>
                            <div class="property-name">BlendProp 2</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator" id="delta-3">+0%</div>
                            <div class="property-value" id="pred-3">0.421</div>
                            <div class="property-name">BlendProp 3</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator" id="delta-4">+0%</div>
                            <div class="property-value" id="pred-4">0.889</div>
                            <div class="property-name">BlendProp 4</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Property Analyzer Tab -->
        <div id="analyzer" class="tab-content">
            <div class="card optimization-card">
                <h2>📊 Advanced Property Analyzer</h2>
                <p>Deep dive into component-property relationships and what-if scenarios</p>
            </div>

            <div class="card">
                <h3>🔍 Component Impact Analysis</h3>
                <div class="chart-container">
                    <canvas id="impactChart"></canvas>
                </div>

                <h3>🌡️ Property Correlation Matrix</h3>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0;">
                    <div style="background: #ff6b35; padding: 10px; border-radius: 5px; text-align: center; color: white;">1.00</div>
                    <div style="background: #f7931e; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.82</div>
                    <div style="background: #667eea; padding: 10px; border-radius: 5px; text-align: center; color: white;">-0.23</div>
                    <div style="background: #764ba2; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.65</div>
                    <div style="background: #f093fb; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.34</div>
                    <div style="background: #f7931e; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.82</div>
                    <div style="background: #ff6b35; padding: 10px; border-radius: 5px; text-align: center; color: white;">1.00</div>
                    <div style="background: #4facfe; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.45</div>
                    <div style="background: #00f2fe; padding: 10px; border-radius: 5px; text-align: center; color: white;">-0.12</div>
                    <div style="background: #43e97b; padding: 10px; border-radius: 5px; text-align: center; color: white;">0.78</div>
                </div>
            </div>
        </div>

        <!-- Optimization Engine Tab -->
        <div id="optimizer" class="tab-content">
            <div class="card optimization-card">
                <h2>🎯 Multi-Objective Optimization Engine</h2>
                <p>Find the optimal blend composition for your specific requirements</p>
            </div>

            <div class="content-grid">
                <div class="card">
                    <h3>🎯 Optimization Goals</h3>
                    
                    <div style="margin: 15px 0;">
                        <label>BlendProp 1 Target: <strong>0.65</strong></label>
                        <input type="range" class="slider" min="0" max="1" step="0.01" value="0.65">
                        <label style="margin-top: 10px; display: block;">Weight: <strong>1.2</strong></label>
                        <input type="range" class="slider" min="0.1" max="2" step="0.1" value="1.2">
                    </div>

                    <div style="margin: 15px 0;">
                        <label>BlendProp 2 Target: <strong>0.55</strong></label>
                        <input type="range" class="slider" min="0" max="1" step="0.01" value="0.55">
                        <label style="margin-top: 10px; display: block;">Weight: <strong>0.8</strong></label>
                        <input type="range" class="slider" min="0.1" max="2" step="0.1" value="0.8">
                    </div>

                    <h4 style="margin: 20px 0 10px 0;">⚖️ Constraints</h4>
                    <div style="margin: 10px 0;">
                        <label><input type="checkbox" checked> Minimize Cost</label><br>
                        <label><input type="checkbox" checked> Environmental Compliance</label><br>
                        <label><input type="checkbox"> Component Availability</label>
                    </div>

                    <button class="btn" onclick="startOptimization()">🚀 Start Optimization</button>
                    <div id="optimization-progress" style="display: none; margin: 15px 0;">
                        <div class="loading"></div> Optimizing blend composition...
                    </div>
                </div>

                <div class="card">
                    <h3>📈 Optimization Results</h3>
                    <div class="chart-container">
                        <canvas id="paretoChart"></canvas>
                    </div>

                    <h4>🏆 Recommended Blend Composition</h4>
                    <div class="optimization-results">
                        <div class="result-item">
                            <div class="property-value">0.245</div>
                            <div class="property-name">Component A</div>
                        </div>
                        <div class="result-item">
                            <div class="property-value">0.189</div>
                            <div class="property-name">Component B</div>
                        </div>
                        <div class="result-item">
                            <div class="property-value">0.223</div>
                            <div class="property-name">Component C</div>
                        </div>
                        <div class="result-item">
                            <div class="property-value">0.167</div>
                            <div class="property-name">Component D</div>
                        </div>
                        <div class="result-item">
                            <div class="property-value">0.176</div>
                            <div class="property-name">Component E</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blend Comparison Tab -->
        <div id="batch" class="tab-content">
            <div class="card prediction-card">
                <h2>📈 Multi-Blend Comparison Tool</h2>
                <p>Compare different blend scenarios side by side</p>
            </div>

            <div class="comparison-grid">
                <div class="blend-comparison">
                    <h4>🔬 Blend A (Current)</h4>
                    <div class="property-grid">
                        <div class="property-item">
                            <div class="property-value">0.652</div>
                            <div class="property-name">Prop 1</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.734</div>
                            <div class="property-name">Prop 2</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.421</div>
                            <div class="property-name">Prop 3</div>
                        </div>
                        <div class="property-item">
                            <div class="property-value">0.889</div>
                            <div class="property-name">Prop 4</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 10px 0;">
                        <strong>Quality Score: 87.4</strong>
                    </div>
                </div>

                <div class="blend-comparison">
                    <h4>🧪 Blend B (Optimized)</h4>
                    <div class="property-grid">
                        <div class="property-item">
                            <div class="delta-indicator delta-positive">+8.2%</div>
                            <div class="property-value">0.705</div>
                            <div class="property-name">Prop 1</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-negative">-3.1%</div>
                            <div class="property-value">0.711</div>
                            <div class="property-name">Prop 2</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-positive">+12.5%</div>
                            <div class="property-value">0.474</div>
                            <div class="property-name">Prop 3</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-positive">+2.8%</div>
                            <div class="property-value">0.914</div>
                            <div class="property-name">Prop 4</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 10px 0;">
                        <strong style="color: #28a745;">Quality Score: 92.1 (+5.4%)</strong>
                    </div>
                </div>

                <div class="blend-comparison">
                    <h4>⚡ Blend C (Cost-Optimized)</h4>
                    <div class="property-grid">
                        <div class="property-item">
                            <div class="delta-indicator delta-negative">-2.4%</div>
                            <div class="property-value">0.636</div>
                            <div class="property-name">Prop 1</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-positive">+4.7%</div>
                            <div class="property-value">0.768</div>
                            <div class="property-name">Prop 2</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-negative">-6.2%</div>
                            <div class="property-value">0.395</div>
                            <div class="property-name">Prop 3</div>
                        </div>
                        <div class="property-item">
                            <div class="delta-indicator delta-positive">+1.5%</div>
                            <div class="property-value">0.902</div>
                            <div class="property-name">Prop 4</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 10px 0;">
                        <strong style="color: #ffc107;">Quality Score: 85.2 (-2.5%)</strong><br>
                        <small style="color: #28a745;">Cost Savings: $12.50/barrel</small>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>📊 Comparative Analysis</h3>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
                <button class="btn" onclick="exportComparison()">📊 Export Comparison Report</button>
            </div>
        </div>

        <!-- Model Insights Tab -->
        <div id="insights" class="tab-content">
            <div class="card optimization-card">
                <h2>🔬 Model Insights & Explainability</h2>
                <p>Understand how your AI model makes predictions</p>
            </div>

            <div class="card">
                <h3>📊 Feature Importance</h3>
                <div class="chart-container">
                    <canvas id="featureChart"></canvas>
                </div>

                <h3>🎯 SHAP Analysis</h3>
                <p style="background: rgba(0,123,255,0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
                    🔍 SHAP values show how each feature contributes to individual predictions
                </p>

                <div style="display: flex; align-items: center; justify-content: space-between; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <span>Base Value: 0.450</span>
                    <span style="color: #28a745;">+0.15 (Comp_A_Prop1)</span>
                    <span style="color: #dc3545;">-0.08 (Comp_B_Prop3)</span>
                    <span style="color: #28a745;">+0.12 (Comp_C_Prop7)</span>
                    <span style="font-weight: bold;">= 0.642 Final</span>
                </div>

                <h3>📈 Model Performance</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: #28a745; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h4>R² Score</h4>
                        <h2>0.947</h2>
                        <p>🟢 Excellent</p>
                    </div>
                    <div style="background: #17a2b8; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h4>RMSE</h4>
                        <h2>0.023</h2>
                        <p>🟢 Good</p>
                    </div>
                    <div style="background: #ffc107; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h4>MAE</h4>
                        <h2>0.018</h2>
                        <p>🟢 Good</p>
                    </div>
                    <div style="background: #6f42c1; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h4>MAPE</h4>
                        <h2>2.3%</h2>
                        <p>🟢 Good</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Shell AI Hackathon Phase 2 | Eagle Team</p>
            <p>Revolutionizing Fuel Blending with Artificial Intelligence</p>
        </div>
    </div>

    <script>
        // Store previous predictions for delta calculations
        let previousPredictions = [0.652, 0.734, 0.421, 0.889];
        let isAssistantOpen = false;
        
        // Training data bounds for anomaly detection (simulated)
        const trainingBounds = {
            components: {
                min: [0.05, 0.05, 0.05, 0.05, 0.05],
                max: [0.6, 0.6, 0.6, 0.6, 0.6]
            },
            properties: {
                min: [0.1, 0.1, 0.1, 0.1],
                max: [0.95, 0.95, 0.95, 0.95]
            }
        };

        // AI Assistant functionality
        function toggleAssistant() {
            const panel = document.getElementById('assistant-panel');
            isAssistantOpen = !isAssistantOpen;
            panel.style.display = isAssistantOpen ? 'flex' : 'none';
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;

            const chatMessages = document.getElementById('chat-messages');
            
            // Add user message
            chatMessages.innerHTML += `<div class="message user-message"><strong>You:</strong> ${message}</div>`;
            
            // Clear input
            input.value = '';
            
            // Generate AI response
            setTimeout(() => {
                const response = generateAIResponse(message);
                chatMessages.innerHTML += `<div class="message ai-message"><strong>AI:</strong> ${response}</div>`;
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1000);
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateAIResponse(message) {
            const msg = message.toLowerCase();
            
            if (msg.includes('reduce') && msg.includes('property')) {
                const propNum = msg.match(/property\s*(\d+)/)?.[1] || '4';
                return `To reduce Property ${propNum}, try: 1) Decrease Component A (high impact), 2) Increase Component D (inversely correlated), 3) Keep Component B below 0.3. Current sensitivity shows -0.12 change per 0.1 Component A reduction.`;
            }
            
            if (msg.includes('component a') || msg.includes('comp a')) {
                return `Component A has the highest impact (0.85 score) on blend properties. It primarily affects Properties 1 & 3. Increasing A above 0.4 may trigger volatility warnings. Optimal range: 0.15-0.35.`;
            }
            
            if (msg.includes('optimize') || msg.includes('best')) {
                return `For optimization: 1) Use the Optimization Engine tab for multi-objective goals, 2) Current best blend: A=0.245, B=0.189, C=0.223, D=0.167, E=0.176, 3) This achieves 94.2% efficiency with minimal warnings.`;
            }
            
            if (msg.includes('cost') || msg.includes('save')) {
                return `Cost optimization tips: 1) Reduce expensive Component B, 2) Increase Component E (lower cost), 3) Check Blend C in comparison tab for $12.50/barrel savings. Monitor quality trade-offs.`;
            }
            
            if (msg.includes('warning') || msg.includes('alert')) {
                return `Current warnings stem from: 1) High Component A (>0.4) = volatility risk, 2) B+C combined (>0.6) = environmental threshold, 3) Low Component D (<0.1) = stability issues. Adjust accordingly.`;
            }
            
            if (msg.includes('stability') || msg.includes('stable')) {
                return `Blend stability depends on: 1) Balanced composition (no component >50%), 2) Component D above 0.15 for stability, 3) A+B ratio below 0.7. Use the stability checker for real-time feedback.`;
            }
            
            return `I can help with: blend optimization, component effects, cost reduction, stability issues, and property predictions. Try asking "How does Component B affect properties?" or "What's the optimal blend for cost?"`;
        }

        // Anomaly detection system
        function detectAnomalies(components, properties = null) {
            const anomalies = [];
            const anomalyPanel = document.getElementById('anomaly-detection');
            const anomalyMessage = document.getElementById('anomaly-message');
            
            // Check component anomalies
            for (let i = 0; i < components.length; i++) {
                if (components[i] < trainingBounds.components.min[i]) {
                    anomalies.push(`Component ${String.fromCharCode(65 + i)} below training range (${components[i].toFixed(3)} < ${trainingBounds.components.min[i]})`);
                }
                if (components[i] > trainingBounds.components.max[i]) {
                    anomalies.push(`Component ${String.fromCharCode(65 + i)} above training range (${components[i].toFixed(3)} > ${trainingBounds.components.max[i]})`);
                }
            }
            
            // Check for unusual combinations
            const sum_AB = components[0] + components[1];
            const sum_CD = components[2] + components[3];
            if (sum_AB > 0.8) {
                anomalies.push(`Unusual A+B combination (${sum_AB.toFixed(3)}) - rarely seen in training data`);
            }
            if (sum_CD < 0.2) {
                anomalies.push(`Unusual C+D combination (${sum_CD.toFixed(3)}) - outside typical training patterns`);
            }
            
            // Check for extreme ratios
            const maxComp = Math.max(...components);
            const minComp = Math.min(...components);
            if (maxComp / minComp > 8) {
                anomalies.push(`Extreme component ratio detected (${(maxComp/minComp).toFixed(1)}:1) - high imbalance risk`);
            }
            
            // Check property anomalies if provided
            if (properties) {
                for (let i = 0; i < properties.length; i++) {
                    if (properties[i] < trainingBounds.properties.min[i] || properties[i] > trainingBounds.properties.max[i]) {
                        anomalies.push(`Property ${i+1} prediction outside normal range (${properties[i].toFixed(3)})`);
                    }
                }
            }
            
            if (anomalies.length > 0) {
                anomalyMessage.innerHTML = anomalies.map(a => `<div style="margin: 5px 0;">• ${a}</div>`).join('');
                anomalyPanel.style.display = 'block';
            } else {
                anomalyPanel.style.display = 'none';
            }
            
            return anomalies.length > 0;
        }
        
        // Tab switching functionality
        function showTab(tabName) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            setTimeout(() => {
                initializeChartsForTab(tabName);
            }, 100);
        }

        // Enhanced slider functionality with stability checking
        function updateSlider(componentId) {
            const slider = document.getElementById(componentId);
            const valueSpan = document.getElementById(componentId + '-value');
            valueSpan.textContent = parseFloat(slider.value).toFixed(3);
            
            const compA = parseFloat(document.getElementById('compA').value);
            const compB = parseFloat(document.getElementById('compB').value);
            const compC = parseFloat(document.getElementById('compC').value);
            const compD = parseFloat(document.getElementById('compD').value);
            
            const remaining = Math.max(0, 1 - (compA + compB + compC + compD));
            document.getElementById('compE-value').textContent = remaining.toFixed(3);
            
            const total = compA + compB + compC + compD + remaining;
            document.getElementById('total-fraction').textContent = total.toFixed(3);
            
            const validationMsg = document.getElementById('validation-message');
            if (Math.abs(total - 1.0) > 0.001) {
                validationMsg.innerHTML = '⚠️ Fractions must sum to 1.0';
                validationMsg.style.color = '#ff6b35';
            } else {
                validationMsg.innerHTML = '✅ Valid blend composition';
                validationMsg.style.color = '#28a745';
            }
            
            // Check blend stability
            checkBlendStability([compA, compB, compC, compD, remaining]);
            
            // Run anomaly detection
            detectAnomalies([compA, compB, compC, compD, remaining]);
        }

        // Blend stability checker
        function checkBlendStability(components) {
            const warnings = [];
            const warningPanel = document.getElementById('stability-warnings');
            const warningList = document.getElementById('warning-list');
            
            // Simulate stability checks based on component ratios
            if (components[0] > 0.4) warnings.push({icon: '🔥', text: 'High Component A may increase volatility risk'});
            if (components[1] + components[2] > 0.6) warnings.push({icon: '⚠️', text: 'Combined B+C exceeds environmental threshold'});
            if (components[3] < 0.1) warnings.push({icon: '🧪', text: 'Low Component D may affect stability'});
            if (Math.max(...components) > 0.5) warnings.push({icon: '⚖️', text: 'Blend composition highly unbalanced'});
            
            if (warnings.length > 0) {
                warningList.innerHTML = warnings.map(w => 
                    `<div class="warning-item"><span class="warning-icon">${w.icon}</span>${w.text}</div>`
                ).join('');
                warningPanel.style.display = 'block';
            } else {
                warningPanel.style.display = 'none';
            }
        }

        // Enhanced predict properties with delta calculation
        function predictProperties() {
            const btn = event.target;
            btn.innerHTML = '<div class="loading"></div> Predicting...';
            btn.disabled = true;
            
            setTimeout(() => {
                const newPredictions = [
                    (Math.random() * 0.6 + 0.2).toFixed(3),
                    (Math.random() * 0.6 + 0.2).toFixed(3),
                    (Math.random() * 0.6 + 0.2).toFixed(3),
                    (Math.random() * 0.6 + 0.2).toFixed(3)
                ];
                
                for (let i = 0; i < 4; i++) {
                    document.getElementById(`pred-${i+1}`).textContent = newPredictions[i];
                    
                    // Calculate and display delta
                    const delta = ((parseFloat(newPredictions[i]) - previousPredictions[i]) / previousPredictions[i] * 100).toFixed(1);
                    const deltaElement = document.getElementById(`delta-${i+1}`);
                    
                    if (Math.abs(delta) < 0.1) {
                        deltaElement.textContent = '±0%';
                        deltaElement.className = 'delta-indicator';
                    } else if (delta > 0) {
                        deltaElement.textContent = `+${delta}%`;
                        deltaElement.className = 'delta-indicator delta-positive';
                    } else {
                        deltaElement.textContent = `${delta}%`;
                        deltaElement.className = 'delta-indicator delta-negative';
                    }
                }
                
                // Run anomaly detection on predictions
                const currentComponents = [
                    parseFloat(document.getElementById('compA').value),
                    parseFloat(document.getElementById('compB').value),
                    parseFloat(document.getElementById('compC').value),
                    parseFloat(document.getElementById('compD').value),
                    parseFloat(document.getElementById('compE-value').textContent)
                ];
                detectAnomalies(currentComponents, newPredictions.map(p => parseFloat(p)));
                
                previousPredictions = newPredictions.map(p => parseFloat(p));
                
                btn.innerHTML = '✨ Prediction Complete!';
                setTimeout(() => {
                    btn.innerHTML = '🔮 Predict Properties';
                    btn.disabled = false;
                }, 2000);
            }, 2000);
        }

        // Simple report generation
        function generateReport() {
            const reportData = {
                timestamp: new Date().toLocaleString(),
                components: {
                    A: document.getElementById('compA-value').textContent,
                    B: document.getElementById('compB-value').textContent,
                    C: document.getElementById('compC-value').textContent,
                    D: document.getElementById('compD-value').textContent,
                    E: document.getElementById('compE-value').textContent
                },
                predictions: {
                    prop1: document.getElementById('pred-1').textContent,
                    prop2: document.getElementById('pred-2').textContent,
                    prop3: document.getElementById('pred-3').textContent,
                    prop4: document.getElementById('pred-4').textContent
                }
            };
            
            const reportText = `Eagle Blend Optimizer Report
Generated: ${reportData.timestamp}

Component Composition:
- Component A: ${reportData.components.A}
- Component B: ${reportData.components.B}
- Component C: ${reportData.components.C}
- Component D: ${reportData.components.D}
- Component E: ${reportData.components.E}

Predicted Properties:
- BlendProp 1: ${reportData.predictions.prop1}
- BlendProp 2: ${reportData.predictions.prop2}
- BlendProp 3: ${reportData.predictions.prop3}
- BlendProp 4: ${reportData.predictions.prop4}

Shell AI Hackathon Phase 2 | Eagle Team`;

            const blob = new Blob([reportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'blend_report.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Export comparison report
        function exportComparison() {
            const reportText = `Blend Comparison Report
Generated: ${new Date().toLocaleString()}

Blend A (Current):
- Property 1: 0.652
- Property 2: 0.734
- Property 3: 0.421
- Property 4: 0.889
- Quality Score: 87.4

Blend B (Optimized):
- Property 1: 0.705 (+8.2%)
- Property 2: 0.711 (-3.1%)
- Property 3: 0.474 (+12.5%)
- Property 4: 0.914 (+2.8%)
- Quality Score: 92.1 (+5.4%)

Blend C (Cost-Optimized):
- Property 1: 0.636 (-2.4%)
- Property 2: 0.768 (+4.7%)
- Property 3: 0.395 (-6.2%)
- Property 4: 0.902 (+1.5%)
- Quality Score: 85.2 (-2.5%)
- Cost Savings: $12.50/barrel

Recommendation: Blend B provides the best overall performance improvement.

Shell AI Hackathon Phase 2 | Eagle Team`;

            const blob = new Blob([reportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'comparison_report.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Optimization functionality
        function startOptimization() {
            const progressDiv = document.getElementById('optimization-progress');
            const btn = event.target;
            
            btn.style.display = 'none';
            progressDiv.style.display = 'block';
            
            setTimeout(() => {
                progressDiv.innerHTML = '✨ Optimization Complete!';
                progressDiv.style.color = '#28a745';
                setTimeout(() => {
                    btn.style.display = 'inline-block';
                    progressDiv.style.display = 'none';
                }, 2000);
            }, 3000);
        }

        // Chart initialization
        function initializeChartsForTab(tabName) {
            if (tabName === 'dashboard') {
                initQualityChart();
            } else if (tabName === 'designer') {
                initRadarChart();
            } else if (tabName === 'analyzer') {
                initImpactChart();
            } else if (tabName === 'optimizer') {
                initParetoChart();
            } else if (tabName === 'batch') {
                initComparisonChart();
            } else if (tabName === 'insights') {
                initFeatureChart();
            }
        }

        function initQualityChart() {
            const ctx = document.getElementById('qualityChart');
            if (!ctx) return;
            
            const data = [];
            const labels = [];
            const now = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);
                labels.push(date.toLocaleDateString());
                data.push(92 + Math.random() * 8);
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Quality Score',
                        data: data,
                        borderColor: '#FF6B35',
                        backgroundColor: 'rgba(255, 107, 53, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: false, min: 85, max: 105 } }
                }
            });
        }

        function initRadarChart() {
            const ctx = document.getElementById('radarChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['BlendProp 1', 'BlendProp 2', 'BlendProp 3', 'BlendProp 4', 'BlendProp 5', 'BlendProp 6'],
                    datasets: [{
                        label: 'Predicted Properties',
                        data: [0.65, 0.73, 0.42, 0.89, 0.56, 0.78],
                        borderColor: '#FF6B35',
                        backgroundColor: 'rgba(255, 107, 53, 0.2)',
                        pointBackgroundColor: '#FF6B35'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { r: { beginAtZero: true, max: 1, ticks: { stepSize: 0.2 } } }
                }
            });
        }

        function initImpactChart() {
            const ctx = document.getElementById('impactChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Component A', 'Component B', 'Component C', 'Component D', 'Component E'],
                    datasets: [{
                        label: 'Impact Score',
                        data: [0.85, 0.42, 0.67, 0.23, 0.71],
                        backgroundColor: ['#FF6B35', '#F7931E', '#667eea', '#764ba2', '#f093fb']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, max: 1 } }
                }
            });
        }

        function initParetoChart() {
            const ctx = document.getElementById('paretoChart');
            if (!ctx) return;
            
            const paretoData = [];
            for (let i = 0; i < 50; i++) {
                paretoData.push({ x: Math.random(), y: 1 - Math.random() * 0.8 });
            }
            
            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Pareto Solutions',
                        data: paretoData,
                        backgroundColor: '#FF6B35',
                        pointRadius: 6
                    }, {
                        label: 'Optimal Solution',
                        data: [{x: 0.8, y: 0.9}],
                        backgroundColor: '#dc3545',
                        pointRadius: 12,
                        pointStyle: 'star'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Quality Score' } },
                        y: { title: { display: true, text: 'Cost Efficiency' } }
                    }
                }
            });
        }

        function initComparisonChart() {
            const ctx = document.getElementById('comparisonChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Property 1', 'Property 2', 'Property 3', 'Property 4'],
                    datasets: [{
                        label: 'Blend A (Current)',
                        data: [0.652, 0.734, 0.421, 0.889],
                        backgroundColor: '#667eea'
                    }, {
                        label: 'Blend B (Optimized)',
                        data: [0.705, 0.711, 0.474, 0.914],
                        backgroundColor: '#28a745'
                    }, {
                        label: 'Blend C (Cost-Opt)',
                        data: [0.636, 0.768, 0.395, 0.902],
                        backgroundColor: '#ffc107'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 1 } }
                }
            });
        }

        function initFeatureChart() {
            const ctx = document.getElementById('featureChart');
            if (!ctx) return;
            
            const features = ['CompA_Prop1', 'CompB_Prop3', 'CompC_Prop7', 'CompA_Prop2', 'CompD_Prop5', 
                             'CompE_Prop1', 'CompB_Prop8', 'CompC_Prop2', 'CompA_Prop9', 'CompD_Prop4'];
            const importance = [0.15, 0.12, 0.11, 0.09, 0.08, 0.07, 0.06, 0.05, 0.04, 0.03];
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: features,
                    datasets: [{ label: 'Feature Importance', data: importance, backgroundColor: '#FF6B35' }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true } }
                }
            });
        }

        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', function() {
            initQualityChart();
            checkBlendStability([0.2, 0.2, 0.2, 0.2, 0.2]);
            detectAnomalies([0.2, 0.2, 0.2, 0.2, 0.2]);
        });
    </script>
</body>
</html>